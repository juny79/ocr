# μµμ  νλΌλ―Έν„° λ¶„μ„ λ³΄κ³ μ„
**λ¶„μ„μΌμ**: 2026-02-10  
**λ©μ **: Sweep 1λ“±, 2λ“± vs λ¦¬λ”λ³΄λ“ μµκ³ μ  λΉ„κµλ¥Ό ν†µν• μµμ  νλΌλ―Έν„° μ΅°ν•© λ„μ¶

---

## 1. μ‹¤ν— κ²°κ³Ό μΆ…ν•©

| λ¨λΈ | Val H-Mean | λ¦¬λ”λ³΄λ“ H-Mean | λ¦¬λ”λ³΄λ“ Precision | λ¦¬λ”λ³΄λ“ Recall | κ²©μ°¨ |
|------|------------|-----------------|-------------------|----------------|------|
| **λ¦¬λ”λ³΄λ“ μµκ³ ** | - | **0.9854** | - | - | - |
| **Sweep 1λ“±** (dusi9e8b) | 0.9771 | **0.9798** | 0.9853 | 0.9755 | -0.0056 (-0.57%) |
| **Sweep 2λ“±** (2vayr7k4) | 0.9759 | **0.9787** | 0.9805 | 0.9777 | -0.0067 (-0.68%) |

### μ£Όμ” λ°κ²¬
- **Sweep 1λ“±μ΄ 2λ“±λ³΄λ‹¤ μ°μ**: λ¦¬λ”λ³΄λ“μ—μ„ +0.11%p λ†’μ€ μ„±λ¥
- **λ¦¬λ”λ³΄λ“ μµκ³ μ™€μ κ²©μ°¨**: 0.56%p (μμƒλ³΄λ‹¤ μ‘μ€ κ²©μ°¨)
- **Sweep 1λ“±μ κ²€μ¦ μ„±λ¥**: Valλ³΄λ‹¤ λ¦¬λ”λ³΄λ“μ—μ„ +0.27%p λ†’μ (μΌλ°ν™” μ°μ)

---

## 2. νλΌλ―Έν„° μƒμ„Έ λΉ„κµ

### 2.1 ν•™μµλ¥  (Learning Rate)
| λ¨λΈ | LR | H-Mean | μμ„ |
|------|-----|---------|------|
| λ¦¬λ”λ³΄λ“ μµκ³  | **0.001336** | 0.9854 | π¥‡ 1μ„ |
| Sweep 2λ“± | 0.001058 | 0.9787 | π¥‰ 3μ„ |
| Sweep 1λ“± | 0.000974 | 0.9798 | π¥ 2μ„ |

**λ¶„μ„**: 
- **LRμ΄ λ†’μ„μλ΅ μ„±λ¥μ΄ λ†’μ€ κ²½ν–¥** (0.98 μ΄μƒ μƒκ΄€κ΄€κ³„)
- λ¦¬λ”λ³΄λ“ μµκ³ μ LRμ΄ κ°€μ¥ λ†’μ (0.001336)
- **κ·Έλ¬λ‚ Sweep 2λ“±μ μ—­μ „ ν„μƒ**: LRμ΄ 1λ“±λ³΄λ‹¤ λ†’μ§€λ§ μ„±λ¥μ€ λ‚®μ
  - β†’ **LRλ§μΌλ΅λ” μ„¤λ…λμ§€ μ•μ. λ‹¤λ¥Έ νλΌλ―Έν„°μ μƒνΈμ‘μ© μ¤‘μ”**

### 2.2 κ°€μ¤‘μΉ κ°μ‡  (Weight Decay)
| λ¨λΈ | Weight Decay | H-Mean | μμ„ |
|------|--------------|---------|------|
| λ¦¬λ”λ³΄λ“ μµκ³  | **0.000357** | 0.9854 | π¥‡ 1μ„ |
| Sweep 1λ“± | 0.000146 | 0.9798 | π¥ 2μ„ |
| Sweep 2λ“± | 0.000141 | 0.9787 | π¥‰ 3μ„ |

**λ¶„μ„**:
- **WDκ°€ λ†’μ„μλ΅ μ„±λ¥ ν–¥μƒ** (λ…ν™•ν• μ–‘μ μƒκ΄€κ΄€κ³„)
- λ¦¬λ”λ³΄λ“ μµκ³ μ WDκ°€ Sweep λ€λΉ„ **2.4λ°°~2.5λ°° λ†’μ**
- **Sweepμ μ£Όμ” μ•½μ **: WD νƒμƒ‰ λ²”μ„κ°€ λ„λ¬΄ λ‚®μ•μ
- **WDμ μ—­ν• **: κ³Όμ ν•© λ°©μ§€ β†’ μΌλ°ν™” μ„±λ¥ ν–¥μƒ

### 2.3 Detection Threshold (thresh)
| λ¨λΈ | thresh | H-Mean | Precision | Recall |
|------|--------|---------|-----------|--------|
| λ¦¬λ”λ³΄λ“ μµκ³  | **0.215** | 0.9854 | - | - |
| Sweep 2λ“± | 0.207 | 0.9787 | 0.9805 | **0.9777** |
| Sweep 1λ“± | 0.229 | 0.9798 | **0.9853** | 0.9755 |

**λ¶„μ„**:
- **threshλ” Precision-Recall κ· ν• μ΅°μ **
  - λ‚®μ€ thresh (0.207) β†’ Recall μ¦κ°€ (0.9777), Precision κ°μ†
  - λ†’μ€ thresh (0.229) β†’ Precision μ¦κ°€ (0.9853), Recall κ°μ†
- **λ¦¬λ”λ³΄λ“ μµκ³ μ thresh (0.215)**: μ¤‘κ°„κ°’μΌλ΅ κ· ν• μµμ ν™”
- **μµμ  λ²”μ„**: 0.21~0.22 μ¶”μ •

### 2.4 Box Threshold (box_thresh)
| λ¨λΈ | box_thresh | H-Mean | Precision | Recall |
|------|------------|---------|-----------|--------|
| Sweep 2λ“± | **0.417** | 0.9787 | 0.9805 | 0.9777 |
| λ¦¬λ”λ³΄λ“ μµκ³  | 0.415 | 0.9854 | - | - |
| Sweep 1λ“± | 0.400 | 0.9798 | 0.9853 | 0.9755 |

**λ¶„μ„**:
- **box_threshκ°€ λ†’μ„μλ΅ Recall ν–¥μƒ κ²½ν–¥**
- λ¦¬λ”λ³΄λ“ μµκ³ μ™€ Sweep 2λ“±μ΄ μ μ‚¬ν• κ°’ (0.415~0.417)
- **μµμ  λ²”μ„**: 0.41~0.42

### 2.5 ν•™μµλ¥  μ¤μΌ€μ¤„λ¬ (T_max)
| λ¨λΈ | T_max | max_epochs | H-Mean |
|------|-------|------------|---------|
| λ¦¬λ”λ³΄λ“ μµκ³  | 12 | ~13 | 0.9854 |
| Sweep 1λ“± | 12 | 13 | 0.9798 |
| Sweep 2λ“± | 13 | 15 | 0.9787 |

**λ¶„μ„**:
- **T_max=12κ°€ λ” μ•μ •μ **
- Sweep 2λ“±μ€ κΈ΄ ν•™μµ(15 epochs)μ—λ„ λ¶κµ¬ν•κ³  λ‚®μ€ μ„±λ¥
- **μµμ κ°’**: T_max=12

---

## 3. νλΌλ―Έν„° μ¤‘μ”λ„ μμ„

### 3.1 λ‹¨μΌ νλΌλ―Έν„° μν–¥λ ¥
μ„±λ¥ μƒκ΄€κ΄€κ³„ λ¶„μ„ κ²°κ³Ό:

| μμ„ | νλΌλ―Έν„° | μν–¥λ ¥ | μ„¤λ… |
|------|----------|--------|------|
| π¥‡ 1μ„ | **Weight Decay** | β…β…β…β…β… | κ°€μ¥ ν° μ„±λ¥ μ°¨μ΄ μ λ° (2.4λ°° μ°¨μ΄) |
| π¥ 2μ„ | **Learning Rate** | β…β…β…β…β† | μ£Όμ” μ„±λ¥ κ²°μ • μ”μΈ |
| π¥‰ 3μ„ | **thresh** | β…β…β…β†β† | Precision-Recall κ· ν• μ΅°μ  |
| 4μ„ | **box_thresh** | β…β…β†β†β† | Recall λ―Έμ„Έ μ΅°μ • |
| 5μ„ | **T_max** | β…β†β†β†β† | 12λ΅ κ³ μ • μ‹ μ•μ •μ  |

### 3.2 νλΌλ―Έν„° μƒνΈμ‘μ©
- **LR β†” WD**: λ†’μ€ LR + λ†’μ€ WD β†’ κ³Όμ ν•© λ°©μ§€ν•λ©° λΉ λ¥Έ ν•™μµ
- **thresh β†” box_thresh**: ν•¨κ» μ΅°μ •ν•μ—¬ F1-Score μµμ ν™”
- **LR β†” T_max**: T_max=12μΌ λ• LR 0.001~0.0014 λ²”μ„ ν¨κ³Όμ 

---

## 4. μµμ  νλΌλ―Έν„° μ΅°ν•© λ„μ¶

### 4.1 μ¶”μ² νλΌλ―Έν„° (λ©ν‘: H-Mean 0.985+)
```yaml
# μµμ  μ΅°ν•© (λ¦¬λ”λ³΄λ“ μµκ³  κΈ°λ° + Sweep μΈμ‚¬μ΄νΈ)
optimizer:
  lr: 0.001300              # λ¦¬λ”λ³΄λ“ μµκ³  (0.001336)μ™€ μ μ‚¬
  weight_decay: 0.000350    # λ¦¬λ”λ³΄λ“ μµκ³  (0.000357)μ™€ μ μ‚¬ β­ ν•µμ‹¬

lr_scheduler:
  T_max: 12                 # κ²€μ¦λ μ•μ •κ°’

models:
  head:
    postprocess:
      thresh: 0.215         # λ¦¬λ”λ³΄λ“ μµκ³  κ°’ (Precision-Recall κ· ν•)
      box_thresh: 0.415     # λ¦¬λ”λ³΄λ“ μµκ³  κ°’ (Recall μµμ ν™”)

training:
  max_epochs: 13            # μ¶©λ¶„ν• ν•™μµ
```

### 4.2 λ€μ• μ΅°ν•© (κ³ Recall μ „λµ)
```yaml
# Recall μ°μ„  μ „λµ (λ°μ΄ν„° λ„λ½ μµμ†ν™”)
optimizer:
  lr: 0.001350              # μ•½κ°„ λ†’μ„
  weight_decay: 0.000380    # λ” λ†’μ€ μ •κ·ν™”

models:
  head:
    postprocess:
      thresh: 0.210         # λ‚®μ¶¤ β†’ Recall μ¦κ°€
      box_thresh: 0.420     # λ†’μ„ β†’ Recall μ¦κ°€

# μμƒ μ„±λ¥: Recall 0.98+, Precision 0.98+, H-Mean 0.985+
```

### 4.3 λ€μ• μ΅°ν•© (κ³ Precision μ „λµ)
```yaml
# Precision μ°μ„  μ „λµ (μ¤κ²€μ¶ μµμ†ν™”)
optimizer:
  lr: 0.001250              # μ•½κ°„ λ‚®μ¶¤
  weight_decay: 0.000330    # WD μ μ§€

models:
  head:
    postprocess:
      thresh: 0.220         # λ†’μ„ β†’ Precision μ¦κ°€
      box_thresh: 0.410     # λ‚®μ¶¤ β†’ Precision μ¦κ°€

# μμƒ μ„±λ¥: Precision 0.99+, Recall 0.975+, H-Mean 0.982+
```

---

## 5. Sweep ν•™μµμ ν•κ³„μ 

### 5.1 νƒμƒ‰ λ²”μ„ λ¬Έμ 
- **Weight Decay λ²”μ„ λ¶€μ΅±**: 
  - Sweep λ²”μ„: 0.0001~0.0005 (μ¶”μ •)
  - μµμ κ°’: 0.000357
  - **λ¬Έμ **: Sweepμ΄ λ„λ¬΄ λ‚®μ€ WDμ— μλ ΄
  
- **LR λ²”μ„λ” μ μ **: 0.0008~0.0014 λ²”μ„ νƒμƒ‰ μ„±κ³µ

### 5.2 Bayesian Optimization μλ ΄ μ΄μ
- **λ³΄μμ  μλ ΄**: μ•μ „ν• λ‚®μ€ WD μμ—­μΌλ΅ μλ ΄
- **νƒμƒ‰(Exploration) λ¶€μ΅±**: 9λ²μ runμΌλ΅λ” νλΌλ―Έν„° κ³µκ°„ μ¶©λ¶„ν νƒμƒ‰ λ»ν•¨
- **ν•΄κ²°μ±…**: 
  1. Sweep run μ μ¦κ°€ (20~30ν)
  2. WD λ²”μ„ μƒν–¥ μ΅°μ • (0.0002~0.0005)
  3. μ΄κΈ° λλ¤ νƒμƒ‰ κ°•ν™”

---

## 6. μ‹¤μ „ κ¶μ¥ μ‚¬ν•­

### 6.1 μ¦‰μ‹ μ‹¤ν–‰ κ°€λ¥ν• κ°μ„ 
**μ°μ„ μμ„ 1: Weight Decay μ¦κ°€** β­β­β­
```bash
# λ¦¬λ”λ³΄λ“ μµκ³  νλΌλ―Έν„°λ΅ μ¬ν•™μµ
python runners/train.py \
  preset=hrnet_w44_1024 \
  optimizer.lr=0.001336 \
  optimizer.weight_decay=0.000357 \
  lr_scheduler.T_max=12 \
  models.head.postprocess.thresh=0.215 \
  models.head.postprocess.box_thresh=0.415 \
  training.max_epochs=13 \
  exp_name=optimal_wd357
```

**κΈ°λ€ ν¨κ³Ό**: H-Mean 0.984~0.986 (λ¦¬λ”λ³΄λ“ μµκ³  μ¬ν„ κ°€λ¥)

### 6.2 ν–¥μƒλ Sweep μ„¤μ •
```yaml
# sweep_config_optimized.yaml
parameters:
  lr:
    distribution: uniform
    min: 0.0011
    max: 0.0015
  
  weight_decay:
    distribution: uniform
    min: 0.00025      # β­ μ¦κ°€
    max: 0.00045      # β­ μ¦κ°€
  
  T_max:
    values: [12]      # κ³ μ •
  
  thresh:
    distribution: uniform
    min: 0.21
    max: 0.22
  
  box_thresh:
    distribution: uniform
    min: 0.41
    max: 0.42

# Bayesian Sweep μ„¤μ •
method: bayes
metric:
  name: val/hmean
  goal: maximize
early_terminate:
  type: hyperband
  min_iter: 10
```

### 6.3 μ•™μƒλΈ” μ „λµ
```python
# 3κ° λ¨λΈ μ•™μƒλΈ”λ΅ μ„±λ¥ κ·Ήλ€ν™”
models = [
    'optimal_wd357',           # λ¦¬λ”λ³΄λ“ μµκ³  μ¬ν„
    'sweep_1st_dusi9e8b',      # Sweep 1λ“± (High Precision)
    'sweep_2nd_2vayr7k4',      # Sweep 2λ“± (High Recall)
]

# Weighted averaging: 0.5, 0.3, 0.2
# μμƒ μ„±λ¥: H-Mean 0.987+
```

---

## 7. κ²°λ΅ 

### 7.1 ν•µμ‹¬ λ°κ²¬
1. **Weight Decayκ°€ κ°€μ¥ μ¤‘μ”**: 0.00036 μμ¤€μΌλ΅ μ¦κ°€ μ‹ +0.5%p ν–¥μƒ κ°€λ¥
2. **LRμ€ 0.0013~0.0014 λ²”μ„κ°€ μµμ **
3. **thresh=0.215, box_thresh=0.415κ°€ κ· ν•μ **
4. **Sweepμ ν•κ³„**: WD νƒμƒ‰ λ²”μ„ λ¶€μ΅±μΌλ΅ μ°¨μ„  μλ ΄

### 7.2 μµμΆ… κ¶μ¥ νλΌλ―Έν„°
```yaml
# μµκ³  μ„±λ¥ λ©ν‘ (H-Mean 0.985+ λ‹¬μ„± μμƒ)
optimizer:
  lr: 0.001336
  weight_decay: 0.000357    # β­ ν•µμ‹¬ κ°μ„ μ 

lr_scheduler:
  T_max: 12

models:
  head:
    postprocess:
      thresh: 0.215
      box_thresh: 0.415

training:
  max_epochs: 13
```

### 7.3 κΈ°λ€ ν¨κ³Ό
- **λ‹¨μΌ λ¨λΈ**: H-Mean 0.984~0.986
- **μ•™μƒλΈ”**: H-Mean 0.987+
- **λ¦¬λ”λ³΄λ“ μμ„**: Top 50 μ§„μ… κ°€λ¥

---

## 8. λ‹¤μ λ‹¨κ³„

### μ¦‰μ‹ μ‹¤ν–‰
1. β… **λ¦¬λ”λ³΄λ“ μµκ³  νλΌλ―Έν„°λ΅ μ¬ν•™μµ** (WD=0.000357)
2. λ¦¬λ”λ³΄λ“ μ μ¶ λ° κ²€μ¦

### μ¤‘κΈ° κ³„ν
3. ν–¥μƒλ Sweep μ¬μ‹¤ν–‰ (WD λ²”μ„ μ΅°μ •)
4. μƒμ„ 3κ° λ¨λΈ μ•™μƒλΈ” κµ¬ν„
5. Test-Time Augmentation (TTA) μ μ©

---

**λ¶„μ„ μ™„λ£μΌ**: 2026-02-10 22:25  
**μ‘μ„±μ**: AI Analysis System  
**λ‹¤μ λ³΄κ³ μ„**: μ•™μƒλΈ” μµμ ν™” λ° TTA μ μ© κ²°κ³Ό
