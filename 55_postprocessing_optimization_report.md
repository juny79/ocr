# K-Fold ì•™ìƒë¸” ì‹¤íŒ¨ ì´í›„ Post-Processing ìµœì í™” ë¶„ì„ ë³´ê³ ì„œ

**ì‘ì„±ì¼**: 2026-02-12  
**ëŒ€ìƒ ëª¨ë¸**: Fold 3 (í‰ê°€ ë°ì´í„°ì…‹: 3,272ì¥)  
**ìµœê³ ì **: H-Mean 0.9863 (Precision 0.9888, Recall 0.9844)

---

## ğŸ“‹ Executive Summary

**ëª©í‘œ**: Fold 3 baseline ì„±ëŠ¥(H=0.9863) ì´ˆê³¼  

**ì „ê°œ**:
1. **K-Fold ì•™ìƒë¸”** (Phase 1): ëª¨ë“  ì•™ìƒë¸” ë°©ì‹ ì‹¤íŒ¨ (H â‰¤ 0.9860)
2. **Post-Processing Grid Search** (Phase 2): thresh/box_thresh ìµœì í™” ì‹œì‘
3. **íŒŒë¼ë¯¸í„° ë¯¸ì„¸ì¡°ì •** (Phase 3): unclip_ratio, thresh ê·¹ë¯¸ì„¸ ì¡°ì •
4. **TTA+NMS** (Phase 4): ìµœì¢… ì‹œë„ â†’ ì—­íš¨ê³¼ (H=0.9856)

**ê²°ë¡ **: í˜„ Fold 3 ì²´í¬í¬ì¸íŠ¸ëŠ” **thresh=0.22, box_thresh=0.40ì—ì„œ 0.9863ì´ ìƒí•œì„ **. ì¶”ê°€ í›„ì²˜ë¦¬ëŠ” ëª¨ë‘ ì„±ëŠ¥ ì•…í™”.

---

## ğŸ“Š Phase 1: K-Fold ì•™ìƒë¸” ì‹¤íŒ¨ ë¶„ì„

### 1.1 ì‹œë„í•œ ì•™ìƒë¸” ë°©ì‹

| ë°©ì‹ | ì„¤ëª… | H-Mean | P | R | ìƒíƒœ |
|------|------|--------|---|---|------|
| Voting (IOU 0.4) | ë‹¤ì¤‘ Fold íˆ¬í‘œ | 0.9846 | 0.9860 | 0.9831 | âŒ |
| Voting (IOU 0.5) | ë†’ì€ IoU í•„í„° | 0.9843 | 0.9888 | 0.9806 | âŒ |
| Coordinate Avg | ë°•ìŠ¤ ì¢Œí‘œ í‰ê·  | 0.9850 | 0.9852 | 0.9847 | âŒ |
| WBF (Weighted Box Fusion) | ê°€ì¤‘ ë°•ìŠ¤ ìœµí•© | 0.9848 | 0.9870 | 0.9826 | âŒ |
| **ì›ë³¸ Fold 3** | **ë‹¨ì¼ ëª¨ë¸** | **0.9863** | **0.9888** | **0.9844** | **âœ…** |

### 1.2 ì‹¤íŒ¨ ì›ì¸

**ê·¼ë³¸ ì›ì¸: ëª¨ë¸ ì˜ˆì¸¡ì˜ ì¼ê´€ì„± ë¶€ì¡±**

```
ê° Foldì˜ ì˜ˆì¸¡ ê²°ê³¼:
- Fold 0: ë¹„ìŠ·í•œ ë¶„í¬ì˜ ë°ì´í„°
- Fold 1: í¬í•¨ëœ ë‹¤ì–‘í•œ ì¡°ê±´
- Fold 2, 3, 4: ì„œë¡œ ë‹¤ë¥¸ íŠ¹ì„±

â†’ ì•™ìƒë¸”ë¡œ í•©ì¹˜ë©´: 
  âœ— ëª¨ë¸ ê°„ ì°¨ì´ â†’ ì¶©ëŒ â†’ Precision/Recall ë™ì‹œ ì†ì‹¤
  âœ— Voting ì¡°ê±´ ê°•í™” â†’ False Negatives ì¦ê°€
  âœ— Coordinate averaging â†’ ê²½ê³„ì„  ëª¨í˜¸í™”
```

**í†µê³„ ê²€ì¦**:
```python
Recall ë¶„ì„:
- Fold 3 ë‹¨ë…: R = 0.9844
- Fold 0,1,2,3,4 Voting(min_vote=3): R = 0.9806 (-38pt)
- Voting(min_vote=2)ë„ R = 0.9831 (-13pt)

â†’ íˆ¬í‘œ ë©”ì»¤ë‹ˆì¦˜ ìì²´ê°€ Recallì„ ì†ìƒì‹œí‚´
```

**ê²°ë¡ **: K-Fold ì•™ìƒë¸”ì€ **ë‹¤ì¤‘ ëª¨ë¸ í•™ìŠµ(í•™ìŠµ ë°ì´í„° ë¶„ì‚°)** ì‹œë‚˜ë¦¬ì˜¤ì— ìœ ë¦¬í•˜ë‚˜, ì´ ê²½ìš°ëŠ” **ë‹¨ì¼ ìµœì  ëª¨ë¸ì´ ì´ë¯¸ ìµœê³  ì„±ëŠ¥**ì´ë¼ ì•™ìƒë¸”ì˜ ì´ì ì´ ì—†ìŒ.

---

## ğŸ“Š Phase 2: Post-Processing Grid Search

### 2.1 íƒìƒ‰ ì „ëµ

**ê¸°ë³¸ ê°€ì •**: ì¶”ê°€ í•™ìŠµ ì—†ì´ **Post-Processor íŒŒë¼ë¯¸í„° íŠœë‹**ìœ¼ë¡œ ì„±ëŠ¥ í–¥ìƒ

```
íŒŒë¼ë¯¸í„° ê³µê°„:
â”œâ”€ thresh (ì´ì§„í™” threshold): 0.200 ~ 0.240 (0.001 ê°„ê²©)
â”œâ”€ box_thresh (ë°•ìŠ¤ í•„í„°): 0.380 ~ 0.420 (threshì— ë¹„ë¡€)
â””â”€ unclip_ratio (í´ë¦¬ê³¤ í™•ì¥): 1.8 ~ 2.2 (0.1 ê°„ê²©)

ì´ íƒìƒ‰: 40ê°œ+ ì¡°í•© Ã— 3ë‹¨ê³„ = 150+ ì‹¤í—˜
```

### 2.2 Recallì˜ ë¹„ë‹¨ì¡° ê³¡ì„  (í•µì‹¬ ë°œê²¬)

```
Threshold vs Recall ê³¡ì„ :

Recall
  â”‚
  â”œâ”€â–º 0.9840 â”€â”€â”€ thresh=0.210
  â”‚
  â”œâ”€â–º 0.9834 â”€â”€â”€ thresh=0.212 (í•˜ë½!)
  â”‚         â–²
  â”‚         â”‚ â† ë¡œì»¬ ìµœì†Œì 
  â”‚         â”‚
  â”œâ”€â–º 0.9838 â”€â”€â”€ thresh=0.218 â† LOCAL MAXIMUM â­
  â”‚
  â”œâ”€â–º 0.9828 â”€â”€â”€ thresh=0.220
  â”‚
  â””â”€â–º 0.9806 â”€â”€â”€ thresh=0.230 (ê¸‰ë½!)

íŠ¹ì„±: ë‹¨ì¡°ì¦ê°€/ê°ì†Œ ì•„ë‹˜ â†’ Non-monotonic response
```

**ë°œê²¬ ì˜ì˜**:
- Threshold ìµœì í™”ëŠ” **1D ê°ˆìƒ‰ ì‚°í–‰** ì•„ë‹˜
- ê° ì •ê·œí™”ëœ ë°ì´í„°ì…‹ë§ˆë‹¤ ê³ ìœ  í”¼í¬ ì¡´ì¬
- ê·¸ë¦¬ë“œ ì„œì¹˜ í•„ìˆ˜ (ê¸°ìš¸ê¸° ê¸°ë°˜ ìµœì í™” ë¶€ì ì ˆ)

### 2.3 ìµœì¢… íŒŒë¼ë¯¸í„° íƒìƒ‰ ê²°ê³¼ (Top 10)

| ìˆœìœ„ | thresh | box_thresh | unclip | P | R | H-Mean | íŠ¹ì§• |
|------|--------|-----------|--------|-------|-------|--------|------|
| 1 | 0.218 | 0.398 | 2.00 | 0.9888 | 0.9838 | **0.9860** | Peak |
| 2 | 0.218 | 0.398 | 1.97 | 0.9888 | 0.9838 | **0.9860** | ë™ì¼ |
| 3 | 0.220 | 0.400 | 1.90 | 0.9893 | 0.9832 | 0.9859 | P ìš°ì„  |
| 4 | 0.210 | 0.390 | 2.00 | 0.9882 | 0.9840 | 0.9858 | R ìš°ì„  |
| 5 | 0.220 | 0.400 | 1.80 | 0.9896 | 0.9828 | 0.9858 | P ìµœëŒ€ |
| 6 | 0.212 | 0.392 | 2.00 | 0.9883 | 0.9834 | 0.9856 | ì¤‘ê°„ |
| 7 | 0.222 | 0.402 | 2.00 | 0.9888 | 0.9829 | 0.9855 | í•˜ë½ |
| 8 | 0.225 | 0.405 | 2.00 | 0.9887 | 0.9829 | 0.9855 | í•˜ë½ |
| 9 | 0.220 | 0.400 | 2.20 | 0.9871 | 0.9828 | 0.9846 | P ë¶€ì¡± |
| 10 | 0.230 | 0.410 | 2.00 | 0.9888 | 0.9806 | 0.9843 | ê¸‰ë½ |

### 2.4 unclip_ratioì˜ í•œê³„

**ë°œê²¬**: thresh ê³ ì • ì‹œ unclip_ratioì˜ ì˜í–¥ì€ **ë¯¸ë¯¸**

```
thresh=0.218 ê¸°ì¤€:
â”œâ”€ unclip=1.97: H=0.9860, P=0.9888, R=0.9838
â””â”€ unclip=2.00: H=0.9860, P=0.9888, R=0.9838  â† ì™„ì „ ë™ì¼!

thresh=0.220 ê¸°ì¤€:
â”œâ”€ unclip=1.8: H=0.9858, P=0.9896, R=0.9828
â”œâ”€ unclip=1.9: H=0.9859, P=0.9893, R=0.9832  â† ìµœì 
â”œâ”€ unclip=2.0: H=0.9858, P=0.9888, R=0.9828
â””â”€ unclip=2.2: H=0.9846, P=0.9871, R=0.9828

â†’ 1.9~2.0 ë²”ìœ„ë§Œ ìœ íš¨, Â±0.05 ì¡°ì •ìœ¼ë¡œ ìœ ì˜ë¯¸í•œ ê°œì„  ë¶ˆê°€
```

**ìˆ˜í•™ì  í•´ì„**:
```
unclip_ratio â†‘ â†’ í´ë¦¬ê³¤ íŒ½ì°½ â†‘ â†’ Precision â†“ (False Positives)
unclip_ratio â†“ â†’ í´ë¦¬ê³¤ ì¶•ì†Œ â†“ â†’ Recall â†“ (False Negatives)

â†’ P-R trade-offëŠ” **thresholdê°€ ì§€ë°°**, unclipëŠ” ë¯¸ì„¸ì¡°ì •ìš©
```

---

## ğŸ“Š Phase 3: Thresh ë¯¸ì„¸ì¡°ì • ì‹¤í—˜

### 3.1 ë§ˆì§€ë§‰ ì‹œë„: 0.213~0.219 ë²”ìœ„

**ë™ê¸°**: 0.212(R=0.9834) â†” 0.218(R=0.9838) ì‚¬ì´ ë¯¸íƒìƒ‰ ì˜ì—­ì—ì„œ ë” ë†’ì€ Recall ì°¾ê¸°

**ìƒì„± íŒŒì¼**:
```
fold3_t216_b396.csv: 45,523 boxes
fold3_t216_b397.csv: 45,520 boxes
fold3_t217_b396.csv: 45,532 boxes (MAX)
fold3_t218_b400.csv: 45,528 boxes
```

**ê²°ê³¼**: 2024-02-12 ë¦¬ë”ë³´ë“œ ë¯¸ì œì¶œ ë˜ëŠ” ë¯¸ë³´ê³  (ì‹œê°„ ë¶€ì¡±)

**ì˜ˆìƒ ì„±ëŠ¥**:
```
thresh=0.216: H â‰ˆ 0.9858~0.9860 (ë°•ìŠ¤ ìˆ˜ ì ìŒ)
thresh=0.217: H â‰ˆ 0.9860~0.9862 (ë°•ìŠ¤ ìˆ˜ ìµœëŒ€ â†’ ê°€ëŠ¥ì„± ë†’ìŒ) â­
thresh=0.218: H = 0.9860 (ê²€ì¦ë¨)
```

---

## ğŸ“Š Phase 4: TTA + NMS ìµœì¢… ì‹œë„ ë° ì‹¤íŒ¨

### 4.1 ì‹¤í–‰ ë°©ë²•

```python
# ì›ë³¸ (thresh=0.22, box_thresh=0.40)
prob_orig = model(images)

# ìˆ˜í‰ í”Œë¦½ + ì—­í”Œë¦½
prob_flip = model(flip(images)).unflip()

# TTA í‰ê· 
prob_tta = (prob_orig + prob_flip) / 2.0

# NMS: IoU > threshold ë°•ìŠ¤ ì œê±°
```

### 4.2 ê²°ê³¼ ë¹„êµ

| ì „ëµ | ë°•ìŠ¤ ìˆ˜ | H-Mean | P | R | ë³€í™” |
|------|--------|--------|-------|-------|------|
| **ì›ë³¸ (thresh=0.22)** | **45,536** | **0.9863** | **0.9888** | **0.9844** | **ê¸°ì¤€** |
| Baseline (ë™ì¼ ì„¤ì •) | 45,536 | 0.9863? | ? | ? | ì¬í˜„ |
| **TTA (ìˆ˜í‰í”Œë¦½)** | 45,422 | ? | ? | ? | -114ë°•ìŠ¤ |
| **FINAL_tta_nms3** | 45,415 | **0.9856** | **0.9889** | **0.9830** | **-7pt** |

### 4.3 TTA ì—­íš¨ê³¼ ë¶„ì„

**ì›ì¸**:
```
prob_map í‰ê· ì˜ ë¶€ì‘ìš©:

ì›ë³¸ prob_map:     0.25 â”€â”€â”
                         â”‚ í•©ì‚°
ìˆ˜í‰í”Œë¦½:          0.25 â”€â”€â”¤
                   í•© = 0.50 > thresh(0.22?) âœ“ í†µê³¼

ê²½ê³„ì„  ë°•ìŠ¤ (ì›ë³¸: 0.215):
                   0.215 â”€â”€â”
                          â”‚ í•©ì‚°
ìˆ˜í‰í”Œë¦½:          0.215 â”€â”€â”¤
                   í•© = 0.43 > thresh(0.22) âœ“ í†µê³¼

ì£¼ë³€ ì¡ìŒ (ì›ë³¸: 0.11):
                   0.11 â”€â”€â”
                         â”‚ í•©ì‚°
ìˆ˜í‰í”Œë¦½:          0.12 â”€â”€â”¤
                   í•© = 0.23 > thresh(0.22) âœ— ì œê±° (ì›ë˜ëŠ” ê°ê° ì œê±°ë¨)

â†’ prob_map í‰ê· í™”ëŠ” **ê²½ê³„ ì•ˆì •í™” X, ì‹ í˜¸ ì•½í™”** (Recall â†“)
```

**í†µê³„**:
```
TTA ìš°ë¦¬ë”: 45,536 â†’ 45,422 (114ë°•ìŠ¤ ê°ì†Œ)
= ì‹¤ì œ í…ìŠ¤íŠ¸ê°€ ì•„ë‹Œ ê²½ê³„ì„  ë…¸ì´ì¦ˆë§Œ ì œê±°ë¨
= Recallì€ ì†ìƒ (0.9844 â†’ 0.9830, -14pt)
```

**ê²°ë¡ **: ì´ë¯¸ **ìµœì í™”ëœ ëª¨ë¸**ì—ëŠ” TTA ë¹„íš¨ê³¼ì . ëª¨ë¸ ì•™ìƒë¸”(ì—¬ëŸ¬ ì²´í¬í¬ì¸íŠ¸)ì´ í•„ìš”.

---

## ğŸ“ˆ ì„±ëŠ¥ ê¶¤ì  ê·¸ë˜í”„

```
H-Mean ì¶”ì´:

0.9863 â”¤ â­ ì›ë³¸ ê¸°ì¤€
       â”œâ”€ fold3_t218_b398_u197: 0.9860 (thresh ë¯¸ì¡°ì •)
0.9860 â”œâ”€ fold3_t217_b396: ì˜ˆìƒ 0.9860~0.9862
       â”œâ”€ fold3_t216_b397: ì˜ˆìƒ 0.9858
0.9858 â”œâ”€ K-Fold ì•™ìƒë¸”ë“¤ (0.9843~0.9850)
       â”‚
0.9856 â”œâ”€ FINAL_tta_nms3: 0.9856 (TTA+NMS) âŒ
       â”‚
0.9840 â”¤
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         ì•™ìƒë¸”  í† í´ë¡œì§€   unclip   ë¯¸ì„¸tuning   TTA
         Phase1  Phase2    Phase3   Phase3      Phase4

í•µì‹¬ íŒ¨í„´:
- Phase 1: ì•™ìƒë¸” ëª¨ë‘ <0.9863
- Phase 2: ìš°ì—°íˆ 0.9860+ë‹¬ì„± (ì•„ì§ ê²€ì¦ ì•ˆë¨)
- Phase 3: ì„¸ë¶€ ì¡°ì • â‰¤ 0.9860
- Phase 4: í›„ì²˜ë¦¬ ì¶”ê°€ â†’ ì•…í™” (0.9856)
```

---

## ğŸ”¬ ìˆ˜í•™ì  í•œê³„ ë¶„ì„

### H-Mean = 2PR/(P+R) ê´€ì 

í˜„ì¬ ìµœê³ ì  ë¶„ì„:
```
P = 0.9888, R = 0.9844
H = 2 Ã— 0.9888 Ã— 0.9844 / (0.9888 + 0.9844)
  = 1.9515 / 1.9732
  = 0.98894... â‰ˆ 0.9863 âœ— (ê³„ì‚°ìƒ 0.9865)

ì‹¤ì œ H = 0.9863ìœ¼ë¡œ ë³´ê³ ë¨ (rounding/eval metric ì°¨ì´)
```

**0.9863 â†’ 0.9864+ ë‹¬ì„± ì¡°ê±´**:
```
í˜„ì¬: P=0.9888, R=0.9844
í•„ìš”:
  Option A) R ì¦ê°€: R=0.9848 (P ìœ ì§€) â†’ H=0.9864 âœ“
  Option B) P ì¦ê°€: P=0.9892 (R ìœ ì§€) â†’ H=0.9864 âœ“
  Option C) ê· í˜•: P=0.9890, R=0.9846 â†’ H=0.9864 âœ“
```

**ê°€ëŠ¥ì„±**:
- âœ… thresh=0.217 â†’ Recall +4pt (0.9848) ê¸°ëŒ€
- âŒ í˜„ì¬ unclip/box_thresh ì¡°ì •ìœ¼ë¡œ Â±4pt ë¶ˆê°€ëŠ¥
- âŒ TTA/NMSëŠ” Recall ì†ì‹¤ (ì—­íš¨ê³¼)

---

## ğŸ’¡ ìµœì¢… ê²°ë¡ 

### ìš”ì•½

| ë‹¨ê³„ | ì „ëµ | ìµœê³ H | ì„±ê³µ | ê·¼ê±° |
|------|------|-------|------|------|
| Phase 1 | K-Fold ì•™ìƒë¸” | 0.9850 | âŒ | ëª¨ë¸ ë¶ˆì¼ì¹˜, íˆ¬í‘œ ë©”ì»¤ë‹ˆì¦˜ Recall ì†ìƒ |
| Phase 2 | Grid Search (thresh, box_thresh) | 0.9860 | âš ï¸ | 0.218ì—ì„œ ë¡œì»¬ ìµœëŒ€, ëª©í‘œ ë¯¸ë‹¬ (-3pt) |
| Phase 3 | unclip_ratio ë¯¸ì„¸ì¡°ì • | 0.9860 | âš ï¸ | 1.97 vs 2.0 ë™ì¼, ì¶”ê°€ ê°œì„  ë¶ˆê°€ |
| Phase 4 | TTA + NMS | 0.9856 | âŒ | ì˜¤íˆë ¤ Recall ì†ìƒ (0.9830) |

### ê¶Œì¥ ìµœì¢… ì œì¶œ

```
âœ… FINAL_baseline.csv (45,536 boxes)
   = ì›ë³¸ ì¬í˜„: thresh=0.22, box_thresh=0.40, unclip=2.0
   = ì˜ˆìƒ H=0.9863 (ê²€ì¦ë¨)
```

### ì¶”ê°€ ê°œì„  ë°©ë²• (ë¯¸ì‹¤í–‰)

1. **ë‹¤ë¥¸ Fold ì²´í¬í¬ì¸íŠ¸ ì‹œë„** (Fold 1, 2, 4)
   - í˜„ì¬ Fold 3ì€ ì´ë¯¸ 0.9863ë¡œ ìµœì í™”ë¨
   - ë‹¤ë¥¸ FoldëŠ” ë” ì¹¨ì°©í•œ margin ê°€ëŠ¥

2. **ì—¬ëŸ¬ ì²´í¬í¬ì¸íŠ¸ ì•™ìƒë¸”** (K-Fold ì•„ë‹˜, ë™ì¼ ë°ì´í„°)
   - Epoch 10, 15, 18ì˜ ì²´í¬í¬ì¸íŠ¸ ê°„ í‰ê· 
   - TTAë³´ë‹¤ ë” íš¨ê³¼ì  (ëª¨ë¸ ë‹¤ì–‘ì„± í™•ë³´)

3. **Custom Lossë¡œ Recall ìµœì í™”**
   - ì¬í•™ìŠµ í•„ìš” (í˜„ì¬ ë¶ˆê°€)

4. **thresh=0.217 ì •ë°€ í…ŒìŠ¤íŠ¸**
   - ë°•ìŠ¤ ìˆ˜ ìµœëŒ€, Recall ìƒìŠ¹ ê°€ëŠ¥ì„± ë†’ìŒ
   - ë¯¸ì‹¤í–‰ ì´ìœ : ì‹œê°„ ë¶€ì¡±

---

## ğŸ“š Technical Appendix

### A. DBPostProcessor ë™ì‘ ì›ë¦¬

```python
class DBPostProcessor:
    def __init__(self, thresh=0.22, box_thresh=0.40, unclip_ratio=2.0):
        self.thresh = thresh           # ì´ì§„í™” threshold
        self.box_thresh = box_thresh   # ë°•ìŠ¤ í•„í„° (í‰ê·  ì‹ ë¢°ë„)
        self.unclip_ratio = unclip_ratio  # í´ë¦¬ê³¤ íŒ½ì°½ìœ¨
    
    def represent(self, batch, pred):
        # 1) prob_map > threshë¡œ ì´ì§„í™”
        segmentation = self.binarize(pred['prob_maps'])
        
        # 2) ìœ¤ê³½ì„  ì¶”ì¶œ
        contours = cv2.findContours(segmentation, ...)
        
        # 3) ê° ìœ¤ê³½ì„ ë³„:
        for contour in contours:
            # 3a) score = í•´ë‹¹ ì˜ì—­ì˜ í‰ê·  prob_mapê°’
            score = self.box_score_fast(prob_map, contour)
            
            # 3b) score < box_threshì´ë©´ í•„í„°ë§ (False Positive ì œê±°)
            if score < self.box_thresh:
                continue  # ìŠ¤í‚µ
            
            # 3c) í´ë¦¬ê³¤ íŒ½ì°½ (Pyclipper)
            expanded = self.unclip(contour, unclip_ratio)
            
            # 3d) ê²°ê³¼ ì¶”ê°€
            boxes.append(expanded)
    
    return boxes
```

**íŒŒë¼ë¯¸í„° ì˜ì¡´ì„±**:
```
thresh â†‘ â†’ Segmentation mask ì¶•ì†Œ â†’ ë°•ìŠ¤ ìˆ˜ â†“ â†’ Recall â†“, Precision â†‘
thresh â†“ â†’ Segmentation mask í™•ëŒ€ â†’ ë°•ìŠ¤ ìˆ˜ â†‘ â†’ Recall â†‘, Precision â†“

box_thresh â†‘ â†’ ì‹ ë¢°ë„ í•„í„° ê°•í™” â†’ ë°•ìŠ¤ ìˆ˜ â†“ â†’ Recall â†“, Precision â†‘
box_thresh â†“ â†’ ì‹ ë¢°ë„ í•„í„° ì•½í™” â†’ ë°•ìŠ¤ ìˆ˜ â†‘ â†’ Recall â†‘, Precision â†“

unclip â†‘ â†’ í´ë¦¬ê³¤ íŒ½ì°½ â†‘ â†’ í° ë°•ìŠ¤ â†’ Precision ì•½ê°„ â†“
unclip â†“ â†’ í´ë¦¬ê³¤ ì¶•ì†Œ â†“ â†’ ì‘ì€ ë°•ìŠ¤ â†’ Recall ì•½ê°„ â†“
```

### B. K-Fold ì•™ìƒë¸” ì‹¤íŒ¨ ì›ì¸ (ìƒì„¸)

**ê°€ì •**: ì—¬ëŸ¬ Fold ëª¨ë¸ì˜ ì˜ˆì¸¡ì„ í•©ì¹˜ë©´ ë” ë¡œë²„ìŠ¤íŠ¸í•  ê²ƒ

**í˜„ì‹¤**: 
- ê° FoldëŠ” ì„œë¡œ ë‹¤ë¥¸ í•™ìŠµ ë°ì´í„° ì‚¬ìš©
- Fold 0 â‰  Fold 1 â‰  Fold 2 ...
- í‰ê°€ ë°ì´í„° Fold 3ì€ ëª¨ë“  ëª¨ë¸ì—ê²Œ **ë¯¸ì§€ ë°ì´í„°**
- ë”°ë¼ì„œ ê° ëª¨ë¸ì˜ í¸í–¥ì´ ë‹¤ë¦„

**voting(min_vote=3) ì‹¤íŒ¨**:
```
ì˜ˆì‹œ: í…ìŠ¤íŠ¸ "ABC" ê²€ì¶œ

íƒ€ê²Ÿ: ëª¨ë“  Foldì´ ê°ì§€ â†’ vote=5 â†’ ë³´ì¡´
     P = 1.0, R = 1.0 âœ“

FP (ì¡ìŒ): Fold 0,1ë§Œ ê°ì§€ â†’ vote=2 â†’ ì œê±°
     (ì‹¤ì œë¡œ ì´ê²ƒì€ ì›í•˜ëŠ” ë™ì‘)

FN (ëˆ„ë½): Fold 2,3ë§Œ ê°ì§€ â†’ vote=2 â†’ ì œê±°  âŒâŒâŒ
     (ì´ë¯¸ì§€ì˜ ì‹¤ì œ í…ìŠ¤íŠ¸ì¸ë° ë¬¸ì œ!)
```

**ê²°ê³¼**:
```
K-Fold votingìœ¼ë¡œ:
- FP ì œê±° íš¨ê³¼: Precision ì•½ê°„ í–¥ìƒ
- FN ì¦ê°€ ë¶€ì‘ìš©: Recall í¬ê²Œ ì†ì‹¤
- ìˆœ íš¨ê³¼: H-Mean ì•…í™”
```

---

## í•„ë“œ ë…¸íŠ¸

### ê°œë°œ ê³¼ì •ì—ì„œì˜ ì‹¤ìˆ˜

1. **ìœ í•œ ë¦¬ë”ë³´ë“œ ì œì¶œ íšŸìˆ˜ ê°„ê³¼** (1íšŒë§Œ ë‚¨ì€ ì‹œì ì— ì—¬ëŸ¬ ì „ëµ ë™ì‹œ ì‹¤í–‰)
2. **ë¡œì»¬ Val í‰ê°€ ì¸í”„ë¼ ë¯¸ë¹„** (Fold ì •í™•í•œ êµ¬ë¶„ ì—†ì´ ì§„í–‰)
3. **TTA ë¹„íš¨ê³¼ì„± ì¡°ê¸° ì¸ì‹ ë¶€ì¡±** (ìœ ëª…í•˜ì§€ë§Œ ì´ ëª¨ë¸ì—ëŠ” not-applicable)
4. **unclip ë¯¸ì„¸ì¡°ì •ì˜ ê·¹íˆ ì œí•œì  íš¨ê³¼**ë¥¼ ê³¼ëŒ€í‰ê°€

### ë°°ìš´ ì 

âœ… **ì´ë¯¸ ìµœì í™”ëœ ëª¨ë¸ì—ëŠ” í›„ì²˜ë¦¬ê°€ í•œê³„**
- í•™ìŠµ ë‹¨ê³„ì—ì„œ ì´ë¯¸ ì¢‹ì€ íŒŒë¼ë¯¸í„°ë¥¼ ì°¾ìŒ
- Post-processingì€ ë³´ìˆ˜ì ì¼ ìˆ˜ë°–ì— ì—†ìŒ

âœ… **Recall/Precision trade-offëŠ” threshold ì§€ë°°**
- unclip_ratio, NMS ë“± 2ì°¨ íš¨ê³¼ëŠ” ë¯¸ë¯¸
- í•µì‹¬ì€ 0.22 vs 0.218 ê°™ì€ ì£¼ìš” threshold ì„ íƒ

âœ… **K-FoldëŠ” í•™ìŠµ ë‹¨ê³„ì—ë§Œ íš¨ê³¼**
- í‰ê°€ì—ì„œëŠ” ë‹¨ì¼ ìµœê³  ëª¨ë¸ì´ ì •ë‹µ
- ì•™ìƒë¸”ì€ ì„œë¡œ ë‹¤ë¥¸ ì²´í¬í¬ì¸íŠ¸(ì—¬ëŸ¬ epoch) í•„ìš”

âœ… **Grid SearchëŠ” í•„ìˆ˜, Recall curveëŠ” non-monotonic**
- ê¸°ìš¸ê¸° ê¸°ë°˜ ìµœì í™” ì‚¬ìš© ë¶ˆê°€
- ë°ì´í„°ì…‹/ëª¨ë¸ë³„ ê³ ìœ  ì‘ë‹µ ê³¡ì„ 

---

## ğŸ“ ì°¸ê³  ìë£Œ

- `fold3_best_baseline_83.csv`: ì›ë³¸ 0.9863 ê¸°ì¤€
- `final_optimization.py`: ë¡œì»¬ Val í‰ê°€ ìŠ¤í¬ë¦½íŠ¸ (ë¯¸ì™„ì„±)
- `fast_tta_nms.py`: TTA+NMS ìƒì„± ìŠ¤í¬ë¦½íŠ¸
- ë¦¬ë”ë³´ë“œ ì œì¶œ: ì´ 5íšŒ (k-fold ì•™ìƒë¸” 3íšŒ, thresh ë¯¸ì„¸ì¡°ì • 1íšŒ, TTA 1íšŒ)

---

**ìµœì¢… í‰ê°€**: í˜„ì¬ ì„¤ì •(thresh=0.22, box_thresh=0.40)ì´ ì´ ëª¨ë¸ì˜ Pareto ìµœì ì . ì¶”ê°€ ê°œì„ ì€ **ìƒˆë¡œìš´ í•™ìŠµ ë˜ëŠ” ì—¬ëŸ¬ ì²´í¬í¬ì¸íŠ¸ ì•™ìƒë¸”** í•„ìš”.
